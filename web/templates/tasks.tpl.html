<div ng-controller="TaskController as taskCtrl" ng-init="taskCtrl.getTasks();">
    <div class="content" style="margin: 0px 22px 0px 22px;">
        <a class="btn light-blue darken-3 z-depth-2" ui-sref="tasks" >Tasks</a>
        <a class="btn light-blue darken-4 z-depth-1"  ui-sref="users" >Users</a>
        
        <a class="btn light-blue darken-4 z-depth-1"  style="float:right" ui-sref="login" ng-click="loginCtrl.logOut()">
            <i class="material-icons right">exit_to_app</i>Logout
        </a>
    </div>
    <div style="border-bottom: 1px solid #01579b">        
        <ul class="row">
            <li class="col l12">
                <span class="input-field light-blue-text text-darken-4 col l6">
                    <input type='text' ng-model="taskCtrl.Tsearch.title" id="title" placeholder='Search by title'/>
<!--                    <label for="title">Search by title</label>-->
                </span>
                <span class="input-field light-blue-text text-darken-4 col l2">
                    <input type='text' ng-model="taskCtrl.Tsearch.created" id="created" placeholder="Search by date: YYYY-MM-DD"/>
<!--                    <label for="created">Search by date: YYYY-MM-DD</label>-->
                </span>
                <select class="browser-default input-field col l1" ng-model="taskCtrl.Tsearch.author" 
                        ng-options="user.id as user.login for user in taskCtrl.users" 
                        id="users">
                    <option ng-click="taskCtrl.Tsearch.author = ''" value="">***</option>
                </select>

                <select class="browser-default input-field col l1" ng-model="taskCtrl.Tsearch.assigner" ng-options="user.id as user.login for user in taskCtrl.users">
                    <option ng-click="taskCtrl.Tsearch.assigner = ''" value="">***</option>
                </select>
                <span class="input-field light-blue-text text-darken-4 col l1">
                    <input type="checkbox" ng-model="showAll" ngTrueValue="0" naFalseValue="1" id="open_only">
                    <label for="open_only">Show closed</label>
                </span>
                <span class="input-field light-blue-text text-darken-4 col l1">
                    <button  class="btn-floating btn-small light-blue darken-4"
                            
                        ui-sref="tasks({
                            title   : taskCtrl.Tsearch.title, 
                            date    : taskCtrl.Tsearch.created,
                            author  : taskCtrl.Tsearch.author,
                            assigner: taskCtrl.Tsearch.assigner
                        })"
                           
                           >
                        <i class="material-icons">refresh</i>
                    </button>
                </span>
                <!--        <tr class="sort">
                            <td ng-click="TsortType = 'title';
                                TsortReverse = !TsortReverse" style="width:55%">title</td>
                            <td ng-click="TsortType = 'created';
                                TsortReverse = !TsortReverse" style="width:15%">date</td>
                            <td ng-click="TsortType = 'author';
                                TsortReverse = !TsortReverse" style="width:10%">author</td>
                            <td ng-click="TsortType = 'assigner';
                                TsortReverse = !TsortReverse" style="width:10%">assigner</td>
                            <td style="width:5%">status</td>
                        </tr>-->
            </li>
        </ul>
    </div>
    <div>
        <ul class="row highlight">
            <!--ng-hide="task.status == 0"-->
            <li ng-repeat="task in taskCtrl.tasks| filter : taskCtrl.Tsearch | orderBy: TsortType: TsortReverse" 
                ng-show="task.status == 1 || showAll == 1"
                class="col l12 highlight">
                <span ng-bind="task.title" class="col l6 "></span>
                <span class="col l2" ng-bind="taskCtrl.asDate(task.created) | date: 'dd MMM yyyy &nbsp; hh:mm'"></span>
                <span class="col l1" ng-bind="taskCtrl.asUser(task.author)"></span>
                <span class="col l1" ng-bind="taskCtrl.asUser(task.assigner)"></span>
                <span class="col l1" ng-bind="taskCtrl.asStatus(task.status)"></span>
                <span class="col l1">
                    <button ng-click="taskCtrl.closeTask(task.id);taskCtrl.getTasks();" class="btn-floating btn-small light-blue darken-4">
                        <i class="material-icons">check</i>
                    </button>
                </span>
            </li>
        </ul>
    </div>
    <div class="row">
        <form ng-submit="taskCtrl.putTask(taskCtrl.curTask);" class="col l12">
            <span class="input-field light-blue-text text-darken-4 col l6">
                <input type="text" ng-model="taskCtrl.curTask.title" id="addtask">
                <label for="addtask">Add task title</label>
            </span>
            <select class="col l1 browser-default offset-l2" 
                    ng-options="user.id as user.login disable when user.is_deleted ==    1 for user in taskCtrl.users" 
                    ng-model="taskCtrl.curTask.author">
            </select>
            <select class="col l1 browser-default" 
                    ng-options="user.id as user.login disable when user.is_deleted ==    1 for user in taskCtrl.users" 
                    ng-model="taskCtrl.curTask.assigner" >
            </select>
            <span class="col l1 offset-l1">
                <button class="btn-floating btn-small light-blue darken-4" type="submit" value="" ng-disabled="taskCtrl.isDisabled()"><i class="material-icons">add</i></button>
            </span>
        </form>
    </div>
    {{taskCtrl.Tsearch}}
</div>
<a class="btn light-blue darken-4 z-depth-0" style="float: right">Last refresh: {{now | date:'dd MMM @HH:mm:ss'}}</a>